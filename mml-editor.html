<!doctype HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
<link href="deroberto.css" rel="stylesheet">
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.js"></script>
<script type="text/javascript" src="mml.js"></script>
<script>
/**
 * Check if we need to update the HTML. Gets called repeatedly.
 * @param opts the dialect options
 */
function updateHTML( opts )
{
    if ( changed )
    {
        var text = $("#source").val();
        $("#target").html(toHTML(text,opts));
        changed = false;
    }
}
$( document ).ready(function() {
  var opts = {
        "description": "Novel markup for De Roberto",
        "section": {"prop": "section"},
        "paragraph": {"prop": ""},
        "codeblocks": {"prop": ""},
        "quotations": {"prop": ""},
        "smartquotes": true,
        "headings": [{"tag":"=","prop":"h1"},{"tag":"-","prop":"h2"},{"tag":"_","prop":"h3"}],
        "dividers": [{"tag":"-----","prop":"dash"}, {"tag":"--+--","prop":"plus"}],
        "charformats": [{"tag":"*","prop":"italics"},{"tag":"`","prop":"letter-spacing"}],
        "paraformats": [{"leftTag":"->","rightTag":"<-","prop":"centered"}],
        "milestones": [{"leftTag":"[","rightTag":"]","prop":"page"}]
    };
  changed = true;
    quotes = {"'":1,"‘":1,"’":1,'"':1,'”':1,'“':1};
  window.setInterval(function() {updateHTML(opts)},300);
  // force update when user modifies the source
  $("#source").keyup( function() {
    changed = true;
  });
}); 
</script>
</head>
<body>
<textarea id="source"></textarea>
<div id="target">
</div>
</body>
</html>
